{"version":3,"sources":["../src/index.ts","../src/AptosConnectGoogleWallet.ts","../src/AptosConnectWallet.ts","../src/AptosConnectAccount.ts","../src/helpers.ts","../src/config.ts","../src/AptosConnectAppleWallet.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { registerWallet } from '@aptos-labs/wallet-standard';\nimport { AptosConnectWalletConfig } from './AptosConnectWallet';\nimport { AptosConnectGoogleWallet } from './AptosConnectGoogleWallet';\nimport { AptosConnectAppleWallet } from './AptosConnectAppleWallet';\n\nexport * from './AptosConnectAccount';\nexport * from './AptosConnectWallet';\nexport { AptosConnectGoogleWallet, AptosConnectAppleWallet };\n\nexport function registerAptosConnect(config: AptosConnectWalletConfig = {}) {\n  const googleWalletPlugin = new AptosConnectGoogleWallet(config);\n  const appleWalletPlugin = new AptosConnectAppleWallet(config);\n  registerWallet(googleWalletPlugin);\n  registerWallet(appleWalletPlugin);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AptosConnectNamespace,\n  AptosDisconnectNamespace,\n  AptosFeatures,\n  AptosGetAccountNamespace,\n  AptosGetNetworkNamespace,\n  AptosOnAccountChangeNamespace,\n  AptosOnNetworkChangeNamespace,\n  AptosSignAndSubmitTransactionFeature,\n  AptosSignAndSubmitTransactionNamespace,\n  AptosSignMessageNamespace,\n  AptosSignTransactionNamespace,\n  AptosWallet,\n} from '@aptos-labs/wallet-standard';\nimport { AptosConnectWallet, AptosConnectWalletConfig } from './AptosConnectWallet';\nimport { walletMetadata } from './config';\n\nexport class AptosConnectGoogleWallet extends AptosConnectWallet implements AptosWallet {\n  readonly name = walletMetadata.google.name;\n\n  readonly icon = walletMetadata.google.icon;\n\n  readonly url = walletMetadata.google.url;\n\n  constructor(config: AptosConnectWalletConfig) {\n    super({ ...config, provider: 'google' });\n  }\n\n  // region AptosWallet\n\n  get features(): AptosFeatures & AptosSignAndSubmitTransactionFeature {\n    return {\n      [AptosConnectNamespace]: {\n        connect: this.connect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosDisconnectNamespace]: {\n        disconnect: this.disconnect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetAccountNamespace]: {\n        account: this.getAccount.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetNetworkNamespace]: {\n        network: this.getNetwork.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnAccountChangeNamespace]: {\n        onAccountChange: this.onAccountChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnNetworkChangeNamespace]: {\n        onNetworkChange: this.onNetworkChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignAndSubmitTransactionNamespace]: {\n        signAndSubmitTransaction: this.signAndSubmitTransaction.bind(this),\n        version: '1.1.0',\n      },\n      [AptosSignMessageNamespace]: {\n        signMessage: this.signMessage.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignTransactionNamespace]: {\n        signTransaction: this.signTransaction.bind(this),\n        version: '1.1',\n      },\n    };\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { ClaimOptions } from '@aptos-connect/wallet-api';\nimport {\n  AccountAddress,\n  AccountAuthenticator,\n  AnyRawTransaction,\n  Aptos,\n  AptosConfig,\n  Ed25519PrivateKey,\n  HexInput,\n  MultiAgentTransaction,\n  Network,\n  NetworkToNodeAPI,\n  SimpleTransaction,\n} from '@aptos-labs/ts-sdk';\nimport {\n  AccountInfo,\n  APTOS_CHAINS,\n  AptosSignAndSubmitTransactionInput,\n  AptosSignAndSubmitTransactionOutput,\n  AptosSignMessageInput,\n  AptosSignMessageOutput,\n  AptosSignTransactionInputV1_1,\n  AptosSignTransactionOutputV1_1,\n  AptosWalletError,\n  AptosWalletErrorCode,\n  NetworkInfo,\n  UserResponse,\n  UserResponseStatus,\n} from '@aptos-labs/wallet-standard';\nimport { deserializePublicKeyB64, serializePublicKeyB64 } from '@identity-connect/crypto';\nimport { ACDappClient, ACDappClientConfig } from '@identity-connect/dapp-sdk';\nimport { AptosConnectAccount } from './AptosConnectAccount';\nimport { customAccountToStandardAccount, networkToChainId, unwrapUserResponse } from './helpers';\n\ninterface SerializedCurrentAccount {\n  address: string;\n  publicKey: string;\n}\n\ntype WithSSOProvider<T> = T & {\n  provider: 'google' | 'apple';\n};\n\nexport interface AptosConnectWalletConfig extends Omit<ACDappClientConfig, 'defaultNetworkName' | 'provider'> {\n  claimSecretKey?: HexInput;\n  network?: Network;\n  preferredWalletName?: string;\n}\n\nexport abstract class AptosConnectWallet {\n  // region connectedAccount\n\n  protected static connectedAccountStorageKey = '@aptos-connect/connectedAccount';\n\n  protected static get connectedAccount(): AccountInfo | undefined {\n    const serialized = localStorage.getItem(AptosConnectWallet.connectedAccountStorageKey);\n    if (!serialized) {\n      return undefined;\n    }\n\n    try {\n      const { address, publicKey } = JSON.parse(serialized) as SerializedCurrentAccount;\n      return new AccountInfo({\n        address: AccountAddress.from(address),\n        publicKey: deserializePublicKeyB64(publicKey),\n      });\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.warn('Inconsistent state, resetting it');\n      this.connectedAccount = undefined;\n      return undefined;\n    }\n  }\n\n  protected static set connectedAccount(value: AccountInfo | undefined) {\n    if (value !== undefined) {\n      const serialized: SerializedCurrentAccount = {\n        address: value.address.toString(),\n        publicKey: serializePublicKeyB64(value.publicKey),\n      };\n      localStorage.setItem(AptosConnectWallet.connectedAccountStorageKey, JSON.stringify(serialized));\n    } else {\n      localStorage.removeItem(AptosConnectWallet.connectedAccountStorageKey);\n    }\n  }\n\n  // endregion\n\n  // region AptosWallet\n\n  readonly version = '1.0.0';\n\n  readonly chains = APTOS_CHAINS;\n\n  // eslint-disable-next-line class-methods-use-this\n  get accounts() {\n    const { connectedAccount } = AptosConnectWallet;\n    return connectedAccount ? [new AptosConnectAccount(connectedAccount)] : [];\n  }\n\n  // endregion\n\n  // PetraWallet\n\n  private readonly aptosClient: Aptos;\n\n  private readonly client: ACDappClient;\n\n  private readonly preferredWalletName?: string;\n  private readonly claimOptions?: ClaimOptions;\n\n  constructor({\n    claimSecretKey,\n    network = Network.MAINNET,\n    preferredWalletName,\n    ...clientConfig\n  }: WithSSOProvider<AptosConnectWalletConfig>) {\n    this.client = new ACDappClient(clientConfig);\n\n    if (!NetworkToNodeAPI[network]) {\n      throw new Error('Network not supported');\n    }\n\n    const aptosConfig = new AptosConfig({ network });\n    this.aptosClient = new Aptos(aptosConfig);\n    this.preferredWalletName = preferredWalletName;\n    this.claimOptions = claimSecretKey ? { network, secretKey: new Ed25519PrivateKey(claimSecretKey) } : undefined;\n  }\n\n  async connect(): Promise<UserResponse<AccountInfo>> {\n    // If this is an auto-connect, try not opening the prompt\n    const { connectedAccount } = AptosConnectWallet;\n    if (connectedAccount !== undefined) {\n      return { args: connectedAccount, status: UserResponseStatus.APPROVED };\n    }\n\n    const response = await this.client.connect({\n      claimOptions: this.claimOptions,\n      preferredWalletName: this.preferredWalletName,\n    });\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    const newConnectedAccount = customAccountToStandardAccount(response.args.account);\n    AptosConnectWallet.connectedAccount = newConnectedAccount;\n\n    return {\n      args: newConnectedAccount,\n      status: UserResponseStatus.APPROVED,\n    };\n  }\n\n  async disconnect() {\n    const { connectedAccount } = AptosConnectWallet;\n    if (connectedAccount) {\n      await this.client.disconnect(connectedAccount.address);\n      AptosConnectWallet.connectedAccount = undefined;\n    }\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async getAccount(): Promise<AccountInfo> {\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      // TODO: this function should fail gracefully\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n    return customAccountToStandardAccount(connectedAccount);\n  }\n\n  async getNetwork(): Promise<NetworkInfo> {\n    const { network } = this.aptosClient.config;\n    const chainId = await this.aptosClient.getChainId();\n    const url = NetworkToNodeAPI[network];\n    return {\n      chainId,\n      name: network,\n      url,\n    };\n  }\n\n  async signMessage(input: AptosSignMessageInput): Promise<UserResponse<AptosSignMessageOutput>> {\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n\n    const chainId = networkToChainId(this.aptosClient.config.network);\n    const { message, nonce } = input;\n\n    const encoder = new TextEncoder();\n    const messageBytes = encoder.encode(message);\n    const nonceBytes = encoder.encode(nonce);\n\n    const response = await this.client.signMessage({\n      chainId,\n      message: messageBytes,\n      nonce: nonceBytes,\n      signerAddress: connectedAccount.address,\n    });\n\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    const { fullMessage, signature } = response.args;\n\n    const extraResponseArgs = {\n      address: connectedAccount.address.toString(),\n      application: this.client.dappInfo.domain,\n      chainId,\n      message,\n      nonce,\n      prefix: 'APTOS' as const,\n    };\n\n    return {\n      args: {\n        fullMessage,\n        signature,\n        ...extraResponseArgs,\n      },\n      status: UserResponseStatus.APPROVED,\n    };\n  }\n\n  async signTransaction(rawTxn: AnyRawTransaction): Promise<UserResponse<AccountAuthenticator>>;\n  async signTransaction(args: AptosSignTransactionInputV1_1): Promise<UserResponse<AptosSignTransactionOutputV1_1>>;\n  async signTransaction(\n    txnOrArgs: AnyRawTransaction | AptosSignTransactionInputV1_1,\n    _asFeePayer?: boolean,\n  ): Promise<UserResponse<AccountAuthenticator | AptosSignTransactionOutputV1_1>> {\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n\n    if ('bcsToBytes' in txnOrArgs) {\n      const transaction = txnOrArgs;\n      const feePayer = transaction.feePayerAddress ? { address: transaction.feePayerAddress } : undefined;\n      const secondarySigners = transaction.secondarySignerAddresses?.map((address) => ({ address }));\n      const response = await this.client.signTransaction({\n        feePayer,\n        secondarySigners,\n        signerAddress: connectedAccount.address,\n        transaction: transaction.rawTransaction,\n      });\n      return unwrapUserResponse(response, (args) => args.authenticator);\n    }\n\n    const requestArgs = txnOrArgs;\n    const response = await this.client.signTransaction({\n      ...requestArgs,\n      signerAddress: connectedAccount.address,\n    });\n\n    return unwrapUserResponse(response, (responseArgs) => {\n      const { authenticator, rawTransaction } = responseArgs;\n      if (!rawTransaction) {\n        throw new Error('Expected raw transaction in response args');\n      }\n\n      const secondarySigners = requestArgs.secondarySigners ?? [];\n      let transaction: AnyRawTransaction;\n      if (secondarySigners.length > 0) {\n        transaction = new MultiAgentTransaction(\n          rawTransaction,\n          secondarySigners.map((s) => s.address),\n          requestArgs.feePayer?.address,\n        );\n      } else {\n        transaction = new SimpleTransaction(rawTransaction, requestArgs.feePayer?.address);\n      }\n\n      return {\n        authenticator,\n        rawTransaction: transaction,\n      };\n    });\n  }\n\n  async signAndSubmitTransaction(\n    args: AptosSignAndSubmitTransactionInput,\n  ): Promise<UserResponse<AptosSignAndSubmitTransactionOutput>> {\n    const { gasUnitPrice, maxGasAmount, payload } = args;\n\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n\n    const response = await this.client.signAndSubmitTransaction({\n      gasUnitPrice,\n      maxGasAmount,\n      network: this.aptosClient.config.network,\n      payload,\n      signerAddress: connectedAccount.address,\n    });\n\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    return {\n      args: { hash: response.args.txnHash },\n      status: UserResponseStatus.APPROVED,\n    };\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async onAccountChange(_callback?: (newAccount: AccountInfo) => void): Promise<void> {\n    // TODO\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async onNetworkChange(_callback?: (newNetwork: NetworkInfo) => void): Promise<void> {\n    // Not applicable\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  AnyPublicKey,\n  Ed25519PublicKey,\n  MultiEd25519PublicKey,\n  MultiKey,\n  PublicKey,\n  SigningScheme,\n} from '@aptos-labs/ts-sdk';\nimport { AccountInfo, APTOS_CHAINS, AptosWalletAccount } from '@aptos-labs/wallet-standard';\n\nexport class AptosConnectAccount implements AptosWalletAccount {\n  // region AptosWalletAccount\n\n  readonly chains = APTOS_CHAINS;\n\n  get address() {\n    return this.#address.toString();\n  }\n\n  get publicKey() {\n    return this.#publicKey.toUint8Array();\n  }\n\n  get signingScheme() {\n    if (this.#publicKey instanceof Ed25519PublicKey) {\n      return SigningScheme.Ed25519;\n    }\n    if (this.#publicKey instanceof MultiEd25519PublicKey) {\n      return SigningScheme.MultiEd25519;\n    }\n    if (this.#publicKey instanceof AnyPublicKey) {\n      return SigningScheme.SingleKey;\n    }\n    if (this.#publicKey instanceof MultiKey) {\n      return SigningScheme.MultiKey;\n    }\n    throw new Error('Unsupported public key type');\n  }\n\n  readonly label?: string;\n\n  readonly features = [];\n\n  // endregion\n\n  // region PetraAccount\n\n  readonly #address: AccountAddress;\n\n  readonly #publicKey: PublicKey;\n\n  constructor({ address, ansName, publicKey }: AccountInfo) {\n    this.#publicKey = publicKey;\n    this.#address = address;\n    this.label = ansName;\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountInfo as ACAccountInfo, UserResponse as ACUserResponse } from '@aptos-connect/wallet-api';\nimport { Network, NetworkToChainId } from '@aptos-labs/ts-sdk';\nimport { AccountInfo, UserResponse, UserResponseStatus } from '@aptos-labs/wallet-standard';\n\nexport function customAccountToStandardAccount({ address, name, publicKey }: ACAccountInfo) {\n  return new AccountInfo({\n    address,\n    ansName: name,\n    publicKey,\n  });\n}\n\nexport function unwrapUserResponse<T, U>(response: ACUserResponse<T>, callback: (args: T) => U): UserResponse<U> {\n  if (response.status === 'dismissed') {\n    return { status: UserResponseStatus.REJECTED };\n  }\n  return { args: callback(response.args), status: UserResponseStatus.APPROVED };\n}\n\nexport function networkToChainId(network: Network): number {\n  switch (network) {\n    case Network.MAINNET:\n      return NetworkToChainId.mainnet;\n    case Network.TESTNET:\n      return NetworkToChainId.testnet;\n    default:\n      return NetworkToChainId.devnet;\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport const walletMetadata = {\n  apple: {\n    icon:\n      // eslint-disable-next-line max-len\n      'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxzdHlsZT4KICAgICAgICBwYXRoIHsKICAgICAgICAgICAgZmlsbDogYmxhY2s7CiAgICAgICAgfQoKICAgICAgICBAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CiAgICAgICAgICAgIHBhdGggewogICAgICAgICAgICAgICAgZmlsbDogd2hpdGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICA8L3N0eWxlPgogICAgPHBhdGgKICAgICAgICBkPSJNMjAuMzkzMiA4LjE4MjQyQzIwLjI1NzggOC4yOTA0MyAxNy44NjggOS42NzUzNyAxNy44NjggMTIuNzU0OUMxNy44NjggMTYuMzE2OCAyMC45MDkgMTcuNTc3IDIxIDE3LjYwODJDMjAuOTg2IDE3LjY4NSAyMC41MTY5IDE5LjMzMzkgMTkuMzk2NiAyMS4wMTQxQzE4LjM5NzcgMjIuNDkyNiAxNy4zNTQ1IDIzLjk2ODggMTUuNzY3NSAyMy45Njg4QzE0LjE4MDQgMjMuOTY4OCAxMy43NzIgMjMuMDIwNyAxMS45Mzk5IDIzLjAyMDdDMTAuMTU0NSAyMy4wMjA3IDkuNTE5NzIgMjQgOC4wNjgwNSAyNEM2LjYxNjM5IDI0IDUuNjAzNDkgMjIuNjMxOSA0LjQzODg5IDIwLjk1MTdDMy4wODk5MiAxOC45Nzg3IDIgMTUuOTEzNiAyIDEzLjAwNDVDMiA4LjMzODQzIDQuOTUwMDEgNS44NjM3OSA3Ljg1MzM0IDUuODYzNzlDOS4zOTYwMiA1Ljg2Mzc5IDEwLjY4MiA2LjkwNTQ5IDExLjY1MDUgNi45MDU0OUMxMi41NzI0IDYuOTA1NDkgMTQuMDEwMSA1LjgwMTM4IDE1Ljc2NTEgNS44MDEzOEMxNi40MzAzIDUuODAxMzggMTguODIwMiA1Ljg2Mzc5IDIwLjM5MzIgOC4xODI0MlpNMTQuOTMxOSAzLjgyNTk4QzE1LjY1NzggMi45NDAyOSAxNi4xNzEyIDEuNzExMzcgMTYuMTcxMiAwLjQ4MjQ0OEMxNi4xNzEyIDAuMzEyMDMxIDE2LjE1NzIgMC4xMzkyMTQgMTYuMTI2OSAwQzE0Ljk0NiAwLjA0NTYwNDYgMTMuNTQxIDAuODA4ODgxIDEyLjY5MzggMS44MTkzOEMxMi4wMjg2IDIuNTk3MDYgMTEuNDA3OCAzLjgyNTk4IDExLjQwNzggNS4wNzE3MUMxMS40MDc4IDUuMjU4OTMgMTEuNDM4MiA1LjQ0NjE0IDExLjQ1MjIgNS41MDYxNUMxMS41MjY4IDUuNTIwNTUgMTEuNjQ4MiA1LjUzNzM1IDExLjc2OTYgNS41MzczNUMxMi44MjkxIDUuNTM3MzUgMTQuMTYxOCA0LjgwNzY4IDE0LjkzMTkgMy44MjU5OFoiIC8+Cjwvc3ZnPg==',\n    name: 'Continue with Apple',\n    url: 'https://aptosconnect.app',\n  },\n  google: {\n    icon:\n      // eslint-disable-next-line max-len\n      'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGFzcz0iaF8yMCB3XzIwIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIzLjU0IDEyLjc2MTNDMjMuNTQgMTEuOTQ1OSAyMy40NjY4IDExLjE2MTggMjMuMzMwOSAxMC40MDkxSDEyLjVWMTQuODU3NUgxOC42ODkxQzE4LjQyMjUgMTYuMjk1IDE3LjYxMjMgMTcuNTEyOSAxNi4zOTQzIDE4LjMyODRWMjEuMjEzOEgyMC4xMTA5QzIyLjI4NTUgMTkuMjExOCAyMy41NCAxNi4yNjM2IDIzLjU0IDEyLjc2MTNaIiBmaWxsPSIjNDI4NUY0Ij48L3BhdGg+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi40OTk1IDIzLjk5OThDMTUuNjA0NSAyMy45OTk4IDE4LjIwNzcgMjIuOTcgMjAuMTEwNCAyMS4yMTM3TDE2LjM5MzggMTguMzI4MkMxNS4zNjQgMTkuMDE4MiAxNC4wNDY3IDE5LjQyNTkgMTIuNDk5NSAxOS40MjU5QzkuNTA0MjUgMTkuNDI1OSA2Ljk2OTAyIDE3LjQwMyA2LjA2NDcgMTQuNjg0OEgyLjIyMjY2VjE3LjY2NDRDNC4xMTQ5MyAyMS40MjI4IDguMDA0MDIgMjMuOTk5OCAxMi40OTk1IDIzLjk5OThaIiBmaWxsPSIjMzRBODUzIj48L3BhdGg+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjA2NTIzIDE0LjY4NTFDNS44MzUyMyAxMy45OTUxIDUuNzA0NTUgMTMuMjU4MSA1LjcwNDU1IDEyLjUwMDFDNS43MDQ1NSAxMS43NDIyIDUuODM1MjMgMTEuMDA1MSA2LjA2NTIzIDEwLjMxNTFWNy4zMzU1N0gyLjIyMzE4QzEuNDQ0MzIgOC44ODgwNyAxIDEwLjY0NDQgMSAxMi41MDAxQzEgMTQuMzU1OCAxLjQ0NDMyIDE2LjExMjIgMi4yMjMxOCAxNy42NjQ3TDYuMDY1MjMgMTQuNjg1MVoiIGZpbGw9IiNGQkJDMDUiPjwvcGF0aD48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyLjQ5OTUgNS41NzM4NkMxNC4xODc5IDUuNTczODYgMTUuNzAzOCA2LjE1NDA5IDE2Ljg5NTYgNy4yOTM2NEwyMC4xOTQgMy45OTUyM0MxOC4yMDI0IDIuMTM5NTUgMTUuNTk5MiAxIDEyLjQ5OTUgMUM4LjAwNDAyIDEgNC4xMTQ5MyAzLjU3NzA1IDIuMjIyNjYgNy4zMzU0NUw2LjA2NDcgMTAuMzE1QzYuOTY5MDIgNy41OTY4MiA5LjUwNDI1IDUuNTczODYgMTIuNDk5NSA1LjU3Mzg2WiIgZmlsbD0iI0VBNDMzNSI+PC9wYXRoPjwvc3ZnPg==',\n    name: 'Continue with Google',\n    url: 'https://aptosconnect.app',\n  },\n} as const;\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AptosConnectNamespace,\n  AptosDisconnectNamespace,\n  AptosFeatures,\n  AptosGetAccountNamespace,\n  AptosGetNetworkNamespace,\n  AptosOnAccountChangeNamespace,\n  AptosOnNetworkChangeNamespace,\n  AptosSignAndSubmitTransactionFeature,\n  AptosSignAndSubmitTransactionNamespace,\n  AptosSignMessageNamespace,\n  AptosSignTransactionNamespace,\n  AptosWallet,\n} from '@aptos-labs/wallet-standard';\nimport { AptosConnectWallet, AptosConnectWalletConfig } from './AptosConnectWallet';\nimport { walletMetadata } from './config';\n\nexport class AptosConnectAppleWallet extends AptosConnectWallet implements AptosWallet {\n  readonly name = walletMetadata.apple.name;\n\n  readonly icon = walletMetadata.apple.icon;\n\n  readonly url = walletMetadata.apple.url;\n\n  constructor(config: AptosConnectWalletConfig) {\n    super({ ...config, provider: 'apple' });\n  }\n\n  // region AptosWallet\n\n  get features(): AptosFeatures & AptosSignAndSubmitTransactionFeature {\n    return {\n      [AptosConnectNamespace]: {\n        connect: this.connect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosDisconnectNamespace]: {\n        disconnect: this.disconnect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetAccountNamespace]: {\n        account: this.getAccount.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetNetworkNamespace]: {\n        network: this.getNetwork.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnAccountChangeNamespace]: {\n        onAccountChange: this.onAccountChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnNetworkChangeNamespace]: {\n        onNetworkChange: this.onNetworkChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignAndSubmitTransactionNamespace]: {\n        signAndSubmitTransaction: this.signAndSubmitTransaction.bind(this),\n        version: '1.1.0',\n      },\n      [AptosSignMessageNamespace]: {\n        signMessage: this.signMessage.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignTransactionNamespace]: {\n        signTransaction: this.signTransaction.bind(this),\n        version: '1.1',\n      },\n    };\n  }\n\n  // endregion\n}\n"],"mappings":"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","names":["import_wallet_standard","import_wallet_standard","import_ts_sdk","import_wallet_standard","import_ts_sdk","import_wallet_standard","response","import_wallet_standard"]}